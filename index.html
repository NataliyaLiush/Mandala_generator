<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8"/>
  <title>Гематрія + Фібоначчі</title>
  <style>
    body { font-family: sans-serif; max-width: 600px; margin: 40px auto; padding: 0 20px; }
    h1 { text-align: center; }
    textarea { width: 100%; height: 80px; font-size: 1rem; }
    button { padding: 10px 20px; font-size: 1rem; margin-top: 10px; }
    pre { background: #f5f5f5; padding: 15px; white-space: pre-wrap; }
  </style>
</head>
<body>
  <h1>Персональна мандала з чисел</h1>
  <p>Напишіть свій намір – отримаєте числовий ряд:</p>
  <textarea id="inputText" placeholder="Наприклад: я заробляю десять тисяч доларів на місяць"></textarea>
  <button onclick="process()">Створити ряд</button>

  <h2>Числовий ряд:</h2>
  <pre id="outputFull">—</pre>

  <h2>Спряжений ряд (8 членів, ітеративне спрощення):</h2>
  <pre id="outputShort">—</pre>

  <script>
    // 1. Мапа Pythagorean-Гематрії
    const gematria = {
      'А':1,'Б':2,'В':3,'Г':4,'Ґ':5,'Д':6,'Е':7,'Є':8,'Ж':9,
      'З':1,'И':2,'І':3,'Ї':4,'Й':5,'К':6,'Л':7,'М':8,'Н':9,
      'О':1,'П':2,'Р':3,'С':4,'Т':5,'У':6,'Ф':7,'Х':8,'Ц':9,
      'Ч':1,'Ш':2,'Щ':3,'Ь':4,'Ю':5,'Я':6
    };

    // Перетворюємо фразу в числовий ряд
    function textToNumbers(text){
      return text.toUpperCase()
                 .split('')
                 .map(ch => gematria[ch] || null)
                 .filter(n => n);
    }

    // Нумерологічна редукція одного числа
    function reduceNumber(n) {
      while (n > 9) {
        n = n.toString()
             .split('')
             .reduce((sum, d) => sum + parseInt(d), 0);
      }
      return n;
    }

    // Ітеративне спрощення сусідніми сумами до довжини 8
    function iterativeFiboSimplify(arr) {
      let row = arr.slice();
      while (row.length > 8) {
        const next = [];
        for (let i = 0; i < row.length - 1; i++) {
          let s = row[i] + row[i+1];
          next.push(reduceNumber(s));
        }
        row = next;
      }
      return row;
    }

    // Обробка натискання кнопки
    function process(){
      const text = document.getElementById('inputText').value;
      const full = textToNumbers(text);
      const short = iterativeFiboSimplify(full);

      document.getElementById('outputFull').textContent  = full.join(', ');
      document.getElementById('outputShort').textContent = short.join(', ');
    }
  </script>
</body>
</html>

